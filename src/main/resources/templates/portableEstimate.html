<!-- 버튼을 감싸는 <div> 요소 추가 -->
<!-- button_fragment.html -->

<th:block th:fragment="button_fragment">
  <div id="buttonWrapper">
    <button type="button" onclick="openModal()"></button>
  </div>
  <style>
    #buttonWrapper {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 9999;
    }

    #buttonWrapper button {
        background-image: url("Images/cartImage.png");
        background-repeat: no-repeat;
        background-size: contain;
        width: 50px;
        height: 50px;
        border: none;
        cursor: pointer;
    }
</style>
</th:block>

<!-- modal_fragment.html -->
<th:block th:fragment="modal_fragment">
  <div id="myModal" class="modal">
    <div class="modal-content">
      <div class="container">
        <div class="row vh-100 justify-content-center align-items-center">
          <div class="col-md-12">
            <h1 class="text-center">견적</h1>
            <form action="/estimate/saveAction" method="post">
              <table class="table table-striped table-hover">
                <tr>
                  <th>항목</th>
                  <th>내용</th>
                  <th></th>
                </tr>

                <!--CPU 부분-->
                <tr th:if="${session.comEstimate.getCpuName() != null and session.comEstimate.getCpuName() != ''}"
                    th:attr="data-cpu-name=${session.comEstimate.getCpuName()}"
                    onclick="showCPUDropdown(this.getAttribute('data-cpu-name'))">
                  <td>
                    <span th:text="CPU"></span>
                    <div class="dropdown-content" id="cpuInfoA"></div>
                  </td>
                  <td>
                    <div>
                      <span th:text="${session.comEstimate.getCpuName()}"></span>
                      <div class="dropdown-content" id="cpuInfoB"></div>
                    </div>
                  </td>
                  <td>
                    <button type="button" class="btn btn-primary"
                            th:text="${session.comEstimate.getCpuName() == null or session.comEstimate.getCpuName() == '' ? '추가' : '수정'}"
                            onclick="location.href='/estimate/cpuParts'">
                    </button>
                  </td>
                </tr>

                <tr th:if="${session.comEstimate.getCpuName() == null or session.comEstimate.getCpuName() == ''}">
                  <td>CPU</td>
                  <td>부품 정보가 없음</td>
                  <td>
                    <button type="button" class="btn btn-primary" th:text="'추가'" onclick="location.href='/estimate/cpuParts'"></button>
                  </td>
                </tr>

                <!--메인보드 부분-->
                <tr th:if="${session.comEstimate.getMainBoard() != null and session.comEstimate.getMainBoard() != ''}"
                    th:attr="data-mb-name=${session.comEstimate.getMainBoard()}"
                    onclick="showMBDropdown(this.getAttribute('data-mb-name'))">
                  <td>
                    <span th:text="MainBoard"></span>
                    <div class="dropdown-content" id="mbInfoA"></div>
                  </td>
                  <td>
                    <div>
                      <span th:text="${session.comEstimate.getMainBoard()}"></span>
                      <div class="dropdown-content" id="mbInfoB"></div>
                    </div>
                  </td>
                  <td>
                    <button type="button" class="btn btn-primary"
                            th:text="${session.comEstimate.getMainBoard() == null or session.comEstimate.getMainBoard() == '' ? '추가' : '수정'}"
                            onclick="location.href='/estimate/mbParts'">
                    </button>
                  </td>
                </tr>
                <tr th:if="${session.comEstimate.getMainBoard() == null or session.comEstimate.getMainBoard() == ''}">
                  <td>Mainboard</td>
                  <td>부품 정보가 없음</td>
                  <td>
                    <button type="button" class="btn btn-primary" th:text="'추가'" onclick="location.href='/estimate/mbParts'"></button>
                  </td>
                </tr>

                <!--RAM 부분-->
                <tr th:if="${session.comEstimate.getRam() != null and session.comEstimate.getRam() != ''}"
                    th:attr="data-ram-name=${session.comEstimate.getRam()}"
                    onclick="showRAMDropdown(this.getAttribute('data-ram-name'))">
                  <td>
                    <span th:text="RAM"></span>
                    <div class="dropdown-content" id="ramInfoA"></div>
                  </td>
                  <td>
                    <div>
                      <span th:text="${session.comEstimate.getRam()}"></span>
                      <div class="dropdown-content" id="ramInfoB"></div>
                    </div>
                  </td>
                  <td>
                    <button type="button" class="btn btn-primary"
                            th:text="${session.comEstimate.getRam() == null or session.comEstimate.getRam() == '' ? '추가' : '수정'}"
                            onclick="location.href='/estimate/ramParts'">
                    </button>
                  </td>
                </tr>

                <tr th:if="${session.comEstimate.getRam() == null or session.comEstimate.getRam() == ''}">
                  <td>RAM</td>
                  <td>부품 정보가 없음</td>
                  <td>
                    <button type="button" class="btn btn-primary" th:text="'추가'" onclick="location.href='/estimate/ramParts'"></button>
                  </td>
                </tr>

                <!--Storage 부분-->
                <tr th:if="${session.comEstimate.getStorage() != null and session.comEstimate.getStorage() != ''}"
                    th:attr="data-storage-name=${session.comEstimate.getStorage()}"
                    onclick="showSTODropdown(this.getAttribute('data-storage-name'))">
                  <td>
                    <span th:text="Storage"></span>
                    <div class="dropdown-content" id="stoInfoA"></div>
                  </td>
                  <td>
                    <div>
                      <span th:text="${session.comEstimate.getStorage()}"></span>
                      <div class="dropdown-content" id="stoInfoB"></div>
                    </div>
                  </td>
                  <td>
                    <button type="button" class="btn btn-primary"
                            th:text="${session.comEstimate.getStorage() == null or session.comEstimate.getStorage() == '' ? '추가' : '수정'}"
                            onclick="location.href='/estimate/storageParts'">
                    </button>
                  </td>
                </tr>
                <tr th:if="${session.comEstimate.getStorage() == null or session.comEstimate.getStorage() == ''}">
                  <td>Storage</td>
                  <td>부품 정보가 없음</td>
                  <td>
                    <button type="button" class="btn btn-primary" th:text="'추가'" onclick="location.href='/estimate/storageParts'"></button>
                  </td>
                </tr>

                <!--Power 부분-->
                <tr th:if="${session.comEstimate.getPower() != null and session.comEstimate.getPower() != ''}"
                    th:attr="data-power-name=${session.comEstimate.getPower()}"
                    onclick="showPOWDropdown(this.getAttribute('data-power-name'))">
                  <td>
                    <span th:text="Power"></span>
                    <div class="dropdown-content" id="powInfoA"></div>
                  </td>
                  <td>
                    <div>
                      <span th:text="${session.comEstimate.getPower()}"></span>
                      <div class="dropdown-content" id="powInfoB"></div>
                    </div>
                  </td>
                  <td>
                    <button type="button" class="btn btn-primary"
                            th:text="${session.comEstimate.getPower() == null or session.comEstimate.getPower() == '' ? '추가' : '수정'}"
                            onclick="location.href='/estimate/powerParts'">
                    </button>
                  </td>
                </tr>
                <tr th:if="${session.comEstimate.getPower() == null or session.comEstimate.getPower()== ''}">
                  <td>Power</td>
                  <td>부품 정보가 없음</td>
                  <td>
                    <button type="button" class="btn btn-primary" th:text="'추가'" onclick="location.href='/estimate/powerParts'"></button>
                  </td>
                </tr>

                <!--GPU 부분-->
                <tr th:if="${session.comEstimate.getGpu() != null and session.comEstimate.getGpu() != ''}"
                    th:attr="data-gpu-name=${session.comEstimate.getGpu()}"
                    onclick="showGPUDropdown(this.getAttribute('data-gpu-name'))">
                  <td>
                    <span th:text="GPU"></span>
                    <div class="dropdown-content" id="gpuInfoA"></div>
                  </td>
                  <td>
                    <div>
                      <span th:text="${session.comEstimate.getGpu()}"></span>
                      <div class="dropdown-content" id="gpuInfoB"></div>
                    </div>
                  </td>
                  <td>
                    <button type="button" class="btn btn-primary"
                            th:text="${session.comEstimate.getGpu() == null or session.comEstimate.getGpu() == '' ? '추가' : '수정'}"
                            onclick="location.href='/estimate/gpuParts'">
                    </button>
                  </td>
                </tr>
                <tr th:if="${session.comEstimate.getGpu() == null or session.comEstimate.getGpu() == ''}">
                  <td>GPU</td>
                  <td>부품 정보가 없음</td>
                  <td>
                    <button type="button" class="btn btn-primary" th:text="'추가'" onclick="location.href='/estimate/gpuParts'"></button>
                  </td>
                </tr>
              </table>
              <div>
                <div>
                  <button type="submit" th:text="${session.comEstimate.getComEstimateID() != 0 ? '수정' : '저장'}"></button>
                </div>
              </div>
              <a th:href="@{/estimate/resetEstimate}">
                <button type="button"> 초기화 </button>
              </a>
            </form>
            <button class="btn btn-secondary" onclick="closeModal()">닫기</button>
          </div>
        </div>
      </div>
      <!-- 추가적인 내용을 포함할 수 있습니다 -->
    </div>
  </div>
  <script th:inline="javascript">
  function openModal() {
        // 모달 창 표시
        document.getElementById("myModal").style.display = "block";
        // 버튼을 감싸는 <div> 숨김
        document.getElementById("buttonWrapper").style.display = "none";
    }

    function closeModal() {
        // 모달 창 숨김
        document.getElementById("myModal").style.display = "none";
        // 버튼을 감싸는 <div> 표시
        document.getElementById("buttonWrapper").style.display = "block";
    }
</script>
  <th:block th:if="${session.userID != null}">
    <script src="/js/Estimate/makeEstimate.js"></script>
  </th:block>
</th:block>



